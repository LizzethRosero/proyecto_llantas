{% extends "base.html" %}
{% block title %} Carrito {% endblock %}
{% block content %}

{% with messages=get_flashed_messages(with_categories=true) %}
{% if messages %}
<ul>
    {% for category,message in messages %}
    <div class="alert alert-{{category}}">
        <li>{{message}}</li>
    </div>
    {% endfor %}
</ul>
{% endif %}
{% endwith %}

<div class="container mt-5">
    <h2>Carrito</h2>
    <div class="row">
        {% for producto in productos %}
        <div class="col-sm-4 mb-3 mb-sm-3">
            <div class="card">
                <img src="{{ url_for('static', filename='img/'+ producto[5]) }}" alt="Llanta 1">
                <div class="card-body">
                    <h5 class="card-title">{{producto[1]}}</h5>
                    <h5 class="card-title">{{producto[2]}}</h5>
                    <p class="card-text">{{producto[3]}}</p>
                    <form action="{{url_for('carrito.agregar_producto',id_producto=producto[0])}}" method="post">
                        cantidad <input type="number" name="cantidad_{{producto[0]}}" id="cantidad_{{producto[0]}}">
                        <button class="btn btn-primary add-to-cart" type="submit">Agregar al Carrito</button>

                    </form>
                </div>
            </div>
        </div>

        {% endfor %}
    </div>

    <!-- <h2 class="mt-5">Carrito de Compras</h2>
    <ul id="cart" class="list-group">
    
     </ul>
    <p class="mt-3">Total: $<span id="total">0</span></p>
</div>

<script>
    $(document).ready(function () {
        var cart = [];

        $(".add-to-cart").click(function () {
            var price = parseFloat($(this).data("price"));
            var product = $(this).data("product");

            cart.push({ product: product, price: price });
            updateCart();
        });

        $(document).on("click", ".remove-from-cart", function () {
            var index = $(this).data("index");
            cart.splice(index, 1);
            updateCart();
        });

        function updateCart() {
            var cartList = $("#cart");
            var totalElement = $("#total");
            var total = 0;

            cartList.empty();

            if (cart.length === 0) {
                cartList.append("<li class='list-group-item'>El carrito está vacío</li>");
            } else {
                for (var i = 0; i < cart.length; i++) {
                    var item = cart[i];
                    cartList.append("<li class='list-group-item'>" + item.product +
                        " - $" + item.price.toFixed(0) +
                        " <button class='btn btn-danger btn-sm remove-from-cart' data-index='" + i + "'>Eliminar</button></li>");
                    total += item.price;
                }
            }

            totalElement.text(total.toFixed(0));
        }
    });
</script> -->

    <div class="container mt-5">
        <h2 class="mb-4">Carrito de Compras</h2>

        <div class="row">
            <div class="col-md-8">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Producto</th>
                            <th>Imagen</th>
                            <th>Cantidad</th>
                            <th>Precio Unitario</th>
                            <th>Total</th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>

                        <tr>
                            <td>Producto 1</td>
                            <td><img src="{{ url_for('static', filename='img/catalogo2.PNG') }}" alt="Producto 2"
                                    class="img-thumbnail" style="max-width: 50px;"></td>
                            <td>
                                <input type="number" class="form-control" value="2" min="1" max="10">
                            </td>
                            <td>$100.000</td>
                            <td>$200.000</td>
                            <td><button class="btn btn-danger btn-sm">Eliminar</button></td>
                            <td><button class="btn btn-danger btn-sm">Modificar</button></td>
                        </tr>

                        <tr>
                            <td>Producto 2</td>
                            <td><img src="{{ url_for('static', filename='img/catalogo3.PNG') }}" alt="Producto 2"
                                    class="img-thumbnail" style="max-width: 50px;"></td>
                            <td>
                                <input type="number" class="form-control" value="1" min="1" max="10">
                            </td>
                            <td>$200.000</td>
                            <td>$400.000</td>
                            <td><button class="btn btn-danger btn-sm">Eliminar</button></td>
                            <td><button class="btn btn-danger btn-sm">Modificar</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Resumen de la Compra</h5>
                        <p class="card-text">Total: $600.000</p>
                        <a href="#" class="btn btn-primary">Proceder al Pago</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </html>
    {% endblock %}